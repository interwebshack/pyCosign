@startuml UC_Signer
!theme plain
skinparam usecase {
  BackgroundColor<<Local>> LightGray
  BackgroundColor<<Registry>> Wheat
  BackgroundColor<<Keyless>> LightBlue
  BackgroundColor<<Batch>> Thistle
}

actor Developer
actor "CI/CD Runner" as CICD

package "pyCosign::Signer" {
  usecase "S-1  Sign & save locally\nğŸ“ file + .sig\nğŸ•µï¸ Offline mode" as S1 <<Local>>
  usecase "S-2  Sign & push to registry\nğŸ“¦ Image ref\nğŸ” Push .sig layer" as S2 <<Registry>>
  usecase "S-3  Sign OCI image in-place\nğŸ“¦ Image ref\nâš ï¸ Requires writable registry" as S3 <<Registry>>
  usecase "S-4  Sign & Rekor only\nğŸ“„ Metadata + log\nğŸ“ No file output" as S4 <<Registry>>
  usecase "S-5  Keyless sign, save locally\nğŸ”‘ Sigstore OIDC\nğŸ“ file.sig" as S5 <<Keyless>>
  usecase "S-6  HSM sign\nğŸ“¦ Registry push\nğŸ” Hardware key" as S6 <<Registry>>
  usecase "S-7  Batch parallel sign\nğŸ§¾ List of targets\nâš™ï¸ Async pool" as S7 <<Batch>>
}

Developer --> S1
Developer --> S2
Developer --> S4
Developer --> S5
Developer --> S6
CICD --> S2
CICD --> S3
CICD --> S4
CICD --> S7
@enduml
