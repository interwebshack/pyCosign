@startuml UC_Attester
!theme plain
skinparam usecase {
  BackgroundColor<<Local>> LightGray
  BackgroundColor<<Registry>> Wheat
  BackgroundColor<<Keyless>> LightBlue
  BackgroundColor<<Batch>> Thistle
  BackgroundColor<<Rekor>> Moccasin
}

actor Developer
actor BuildSystem

package "pyCosign::Attester" {
  usecase "A-1  Local attestation\nğŸ“„ JSON â†’ .att\nğŸ—‚ï¸ FS storage, key file" as A1 <<Local>>
  usecase "A-2  Attest & push registry\nğŸ§¾ SPDX SBOM\nğŸ“¦ Push .att to OCI" as A2 <<Registry>>
  usecase "A-3  Rekor-only attestation\nğŸ“„ Any format\nğŸ“¤ Upload to Rekor" as A3 <<Rekor>>
  usecase "A-4  Attest OCI image\nğŸ“¦ CycloneDX SBOM\nğŸ–‹ï¸ Sign existing image" as A4 <<Registry>>
  usecase "A-5  Keyless attestation local\nğŸ“„ Any\nğŸ”‘ Fulcio cert + .att" as A5 <<Keyless>>
  usecase "A-6  Batch attest\nğŸ§¾ List of digests\nâš™ï¸ Parallel attest, any store" as A6 <<Batch>>
  usecase "A-7  HSM attest & push\nğŸ“¦ OCI registry\nğŸ” PKCS #11 key" as A7 <<Registry>>
}

Developer --> A1
Developer --> A2
Developer --> A3
Developer --> A5
BuildSystem --> A2
BuildSystem --> A4
BuildSystem --> A6
BuildSystem --> A7
@enduml
